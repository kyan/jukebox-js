(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{115:function(e,t,a){e.exports=a.p+"static/media/default-artwork.6bba9800.png"},345:function(e,t){e.exports={transformUrl:e=>{const t=e.replace(/^.*\/track\//,"spotify:track:");return t.match(/spotify:track/g)?t:null}}},385:function(e,t,a){e.exports=a(713)},423:function(e,t){},563:function(e,t,a){},622:function(e,t,a){},638:function(e,t,a){},640:function(e,t,a){},641:function(e,t,a){},688:function(e,t,a){},689:function(e,t,a){},710:function(e,t,a){},712:function(e,t,a){},713:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"updateToken",(function(){return Y})),a.d(n,"clearToken",(function(){return q})),a.d(n,"addNewTrack",(function(){return G})),a.d(n,"addCurrentTrack",(function(){return F})),a.d(n,"syncSocialData",(function(){return H})),a.d(n,"addTrackList",(function(){return J})),a.d(n,"removeFromTracklist",(function(){return W})),a.d(n,"updateProgressTimer",(function(){return Q})),a.d(n,"wsConnect",(function(){return X})),a.d(n,"wsConnecting",(function(){return Z})),a.d(n,"wsConnected",(function(){return $})),a.d(n,"wsDisconnect",(function(){return ee})),a.d(n,"wsDisconnected",(function(){return te})),a.d(n,"mopidyConnected",(function(){return ae})),a.d(n,"mopidyDisconnected",(function(){return ne})),a.d(n,"getCurrentTrack",(function(){return re})),a.d(n,"getTimePosition",(function(){return ce})),a.d(n,"getState",(function(){return le})),a.d(n,"getTrackList",(function(){return se})),a.d(n,"clearTrackList",(function(){return oe})),a.d(n,"startPlaying",(function(){return ie})),a.d(n,"stopPlaying",(function(){return ue})),a.d(n,"pausePlaying",(function(){return me})),a.d(n,"nextPlaying",(function(){return de})),a.d(n,"previousPlaying",(function(){return Ee})),a.d(n,"getVolume",(function(){return pe})),a.d(n,"updateVolume",(function(){return ke})),a.d(n,"updatePlaybackState",(function(){return be})),a.d(n,"setVolume",(function(){return Ce}));var r=a(0),c=a.n(r),l=a(22),s=a.n(l),o=a(23),i=a(49),u=a(342),m=a(97),d=a.n(m),E=a(343);class p extends c.a.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){this.setState({hasError:!0})}render(){return this.state.hasError?c.a.createElement("h1",null,"Ouch! I broke a bit."):this.props.children}}var k=p;var b=c.a.createContext(),C=a(344),g=a.n(C),y="playback.getCurrentTrack",v="event:trackPlaybackStarted",h="event:playbackStateChanged",O="event:trackPlaybackResumed",N="tracklist.getTracks",T="tracklist.add",f="tracklist.remove",S="tracklist.clear",D="playback.getTimePosition",A="playback.getState",_="playback.play",P="playback.stop",j="playback.pause",R="playback.next",w="playback.previous",I="playing",x="paused",U="stopped",L="mixer.setVolume",M="mixer.getVolume",V="event:volumeChanged",K="validationError",B={ADD_CURRENT_TRACK:"actionAddCurrentTrack",ADD_TRACKS:"actionAddTracks",CONNECT:"actionConnect",CONNECTING:"actionConnecting",CONNECTED:"actionConnected",DISCONNECT:"actionDisconnect",DISCONNECTED:"actionDisconnected",DROP_TYPES:["__NATIVE_URL__"],SEND:"actionSend",STORE_TOKEN:"actionStoreToken",CLEAR_STORE_TOKEN:"actionClearStoreToken",UPDATE_VOLUME:"actionUpdateVolume",UPDATE_PLAYBACK_STATE:"actionPlaybackState",UPDATE_PROGRESS_TIMER:"actionUpdateProgressTimer",MOPIDY_CONNECTED:"actionMopidyConnected",MOPIDY_DISCONNECTED:"actionMopidyDisconnected",SYNC_SOCIAL_DATA:"syncSocialData"},z=a(345);const Y=e=>({type:B.STORE_TOKEN,token:e}),q=()=>({type:B.CLEAR_STORE_TOKEN}),G=e=>{let t=Object(z.transformUrl)(e);return{type:B.SEND,key:T,params:{uris:[t]}}},F=e=>({type:B.ADD_CURRENT_TRACK,track:e}),H=e=>({type:B.SYNC_SOCIAL_DATA,track:e}),J=e=>({type:B.ADD_TRACKS,list:e}),W=e=>({type:B.SEND,key:f,params:{criteria:{uri:[e]}}}),Q=(e,t)=>(t===1/0&&(t=0),{type:B.UPDATE_PROGRESS_TIMER,position:e,duration:t}),X=()=>({type:B.CONNECT}),Z=()=>({type:B.CONNECTING}),$=()=>({type:B.CONNECTED}),ee=()=>({type:B.DISCONNECT}),te=()=>({type:B.DISCONNECTED}),ae=()=>({type:B.MOPIDY_CONNECTED}),ne=()=>({type:B.MOPIDY_DISCONNECTED}),re=()=>({type:B.SEND,key:y}),ce=()=>({type:B.SEND,key:D}),le=()=>({type:B.SEND,key:A}),se=()=>({type:B.SEND,key:N}),oe=()=>({type:B.SEND,key:S}),ie=()=>({type:B.SEND,key:_}),ue=()=>({type:B.SEND,key:P}),me=()=>({type:B.SEND,key:j}),de=()=>({type:B.SEND,key:R}),Ee=()=>({type:B.SEND,key:w}),pe=()=>({type:B.SEND,key:M}),ke=e=>({type:B.UPDATE_VOLUME,volume:e}),be=e=>({type:B.UPDATE_PLAYBACK_STATE,state:e}),Ce=e=>({type:B.SEND,key:L,params:[Number(e)]});var ge="actionVote",ye="castVote",ve="voteCasted",he="actionTrackSearch",Oe="searchGetTracks",Ne="actionStoreSearchResults",Te="actionStoreSearchQuery",fe="actionToggleSearchSidebar",Se="actionRemoveFromSearchResults",De=a(346),Ae=a.n(De);const _e=e=>{let t=Math.floor(e/6e4),a=(e%6e4/1e3).toFixed(0);return t+":"+(a<10?"0":"")+a},Pe=e=>.001*e,je=e=>({type:fe,open:e}),Re=e=>({type:Te,query:e}),we=(e,t)=>({type:he,key:Oe,params:{query:e,options:t}});var Ie="authenticationTokenInvalid";var xe={decode:e=>JSON.parse(e),encodeToJson:({jwt:e,key:t,data:a})=>JSON.stringify({jwt:e,key:t,data:a})};var Ue={info:({id:e,title:t,message:a})=>m.store.addNotification({id:e,title:t,message:a,type:"info",insert:"top",container:"bottom-left",dismiss:{duration:3e3}}),success:({id:e,title:t,message:a})=>m.store.addNotification({id:e,title:t,message:a,type:"success",insert:"top",container:"bottom-left",dismiss:{duration:3e3}}),warning:({id:e,title:t,message:a})=>m.store.addNotification({id:e,title:t,message:a,type:"warning",insert:"top",container:"bottom-left",dismiss:{duration:5e3}})};const Le=(e,t)=>{e.dispatch(be(t))};var Me=(e,t,a)=>{const n=xe.decode(t),r=n.key,c=n.data,l=n.user;switch(r){case Ie:console.error("AUTHENTICATION_TOKEN_INVALID: ".concat(c.error)),e.dispatch(q());break;case y:case v:c&&c.track&&((e,t,a)=>{t.dispatch(F(e)),t.dispatch(H(e));const n=a.set(0,e.length);t.getState().jukebox.playbackState===I&&n.start()})(c.track,e,a);break;case h:case A:((e,t,a)=>{switch(t){case x:case U:Le(e,t),a.stop();break;case I:Le(e,t),a.start()}})(e,c,a);break;case N:((e,t)=>{t.dispatch(J(e))})(c,e);break;case R:case w:e.dispatch(re());break;case L:Ue.info({title:"Volume Updated",message:"".concat(l.fullname," changed it to ").concat(c.volume)});break;case f:Ue.warning({title:"Track Removed",message:"".concat(l.fullname," removed: ").concat(c.message)});break;case T:Ue.success({title:"New Track",message:"".concat(l.fullname," added: ").concat(c.message)});break;case M:case V:e.dispatch(ke(c.volume));break;case D:a.set(c);break;case Oe:e.dispatch({type:Ne,results:c});break;case ve:c&&e.dispatch(H(c));break;case O:a.set(c);break;case K:Ue.warning({title:"Oops",message:c.message})}};var Ve={loadInitial:e=>{["getCurrentTrack","getState","getTrackList","getVolume","getTimePosition"].forEach(t=>{e.dispatch(n[t]())})}};var Ke=(()=>{let e,t="http://".concat("jukebox-api-prod.local",":").concat("8080"),a=null;return r=>c=>l=>{const s=()=>xe.encodeToJson({jwt:r.getState().settings.token,key:l.key,data:l.params}),o=e=>{if(JSON.parse(e).online)return r.dispatch(ae()),Ve.loadInitial(r);r.dispatch(ne())},i=()=>{a=((e,t)=>Ae()({callback:(a,n)=>{e.dispatch(t.updateProgressTimer(a,n))},fallbackTargetFrameRate:1,disableRequestAnimationFrame:!0}))(r,n),r.dispatch($())},u=()=>r.dispatch(ee()),m=e=>Me(r,e,a),d=e=>Me(r,e,a),E=e=>Me(r,e,a);switch(l.type){case B.CONNECT:return null!=e&&e.close(),e=g()(t,{transports:["websocket"]}),e.on("vote",E),e.on("search",d),e.on("mopidy",o),e.on("message",m),e.on("connect",i),e.on("disconnect",u),void r.dispatch(Z());case B.DISCONNECT:return a&&a.reset(),void r.dispatch(te());case B.SEND:return e&&e.emit("message",s());case he:return e&&e.emit("search",s());case ge:return e&&e.emit("vote",s());default:return c(l)}}})();var Be=(e=null,t)=>{switch(t.type){case B.ADD_CURRENT_TRACK:return t.track;case B.SYNC_SOCIAL_DATA:return Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics});default:return e}};var ze=(e=[],t)=>{switch(t.type){case B.ADD_TRACKS:return t.list.map(e=>e.track);case B.SYNC_SOCIAL_DATA:return e.map(e=>e.uri===t.track.uri?Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics}):e);default:return e}};const Ye={position:0,duration:0,remaining:0};var qe=(e=Ye,t)=>{switch(t.type){case B.UPDATE_PROGRESS_TIMER:return{position:t.position,duration:t.duration,remaining:t.duration-t.position};default:return e}};const Ge={online:!1,mopidyOnline:!1,volume:0,playbackState:U};var Fe=(e=Ge,t)=>{switch(t.type){case B.CONNECTED:return Object.assign({},e,{online:!0});case B.DISCONNECTED:return Object.assign({},e,{online:!1});case B.MOPIDY_CONNECTED:return Object.assign({},e,{mopidyOnline:!0});case B.MOPIDY_DISCONNECTED:return Object.assign({},e,{mopidyOnline:!1});case B.UPDATE_VOLUME:return Object.assign({},e,{volume:t.volume});case B.UPDATE_PLAYBACK_STATE:return Object.assign({},e,{playbackState:t.state});default:return e}};const He={token:null};var Je=(e=He,t)=>{switch(t.type){case B.STORE_TOKEN:return t.token===e.token?e:Object.assign({},e,{token:t.token});case B.CLEAR_STORE_TOKEN:return Object.assign({},e,{token:null});default:return e}},We=a(229);const Qe={searchSideBarOpen:!1,query:"",limit:20,offset:0,total:0,results:[]};var Xe=(e=Qe,t)=>{switch(t.type){case Se:return Object(We.a)(Object(We.a)({},e),{},{results:e.results.filter(e=>e.track.uri!==t.uri)});case fe:return Object.assign({},e,{searchSideBarOpen:t.open});case Te:return Object.assign({},e,{query:t.query});case Ne:const a=t.results.tracks;return Object.assign({},e,{limit:a.limit,offset:a.offset,total:a.total>1e4?1e4:a.total,results:a.items});default:return e}};var Ze=Object(i.combineReducers)({track:Be,tracklist:ze,timer:qe,jukebox:Fe,settings:Je,search:Xe}),$e=a(727),et=a(91),tt=a(156),at=a.n(tt),nt=a(228);var rt={refresh:(e,t)=>nt.b(()=>{e.reloadAuthResponse().then(e=>(console.info("Token refreshed OK"),t(e.id_token)),e=>console.warn("Token un-refreshable: ",e.message))},27e5),clear:e=>{e&&nt.a(e)}},ct=a(739),lt=a(726),st=a(742),ot=a(741),it=a(738),ut=a(62);const mt=e=>c.a.createElement(it.a,{onClick:e.onClick,animated:"vertical",className:"jb-previous-button",disabled:e.disabled},c.a.createElement(it.a.Content,{hidden:!0},"Prev"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"step backward"}))),dt=e=>c.a.createElement(it.a,{onClick:e.onClick,animated:"vertical",className:"jb-next-button",disabled:e.disabled},c.a.createElement(it.a.Content,{hidden:!0},"Next"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"step forward"})));var Et=({disabled:e,onPrevious:t,onNext:a})=>c.a.createElement(c.a.Fragment,null,c.a.createElement(mt,{onClick:t,disabled:e}),c.a.createElement(dt,{onClick:a,disabled:e}));const pt=e=>c.a.createElement(it.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===I||e.disabled,active:e.state===I,className:"jb-play-button"},c.a.createElement(it.a.Content,{hidden:!0},"Play"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"play"}))),kt=e=>c.a.createElement(it.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===x||e.state===U||e.disabled,active:e.state===x,className:"jb-pause-button"},c.a.createElement(it.a.Content,{hidden:!0},"Pause"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"pause"}))),bt=e=>c.a.createElement(it.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===U||e.disabled,active:e.state===U,className:"jb-stop-button"},c.a.createElement(it.a.Content,{hidden:!0},"Stop"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"stop"})));var Ct=e=>{const t=Object(o.c)(e=>e.jukebox),a=e.disabled,n=e.onPlay,r=e.onPause,l=e.onStop,s=e.onPrevious,i=e.onNext;return c.a.createElement("span",null,c.a.createElement(Et,{disabled:a,onPrevious:s,onNext:i}),c.a.createElement(pt,{onClick:n,state:t.playbackState,disabled:a}),c.a.createElement(kt,{onClick:r,state:t.playbackState,disabled:a}),c.a.createElement(bt,{onClick:l,state:t.playbackState,disabled:a}))};a(563);const gt={drop(e,t){e.onDrop&&e.onDrop(e,t)}};class yt extends r.Component{render(){const e=this.props,t=e.connectDropTarget,a=e.isOver;return t(c.a.createElement("div",null,a?c.a.createElement("div",{className:"drag-is-over"},c.a.createElement("p",null,"Drop da track")):null,this.props.children))}}var vt=Object(et.DropTarget)(e=>e.accepts,gt,(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver()}))(yt);var ht=({disabled:e,onDrop:t,children:a})=>e?a:c.a.createElement(et.DragDropContextProvider,{backend:at.a},c.a.createElement(vt,{accepts:B.DROP_TYPES,onDrop:t},a));var Ot=a(735),Nt=a(376),Tt=a(164),ft=a(374),St=a(734),Dt=a(732),At=a(160),_t=a.n(At);a(622);const Pt=e=>c.a.createElement(St.a,{className:"added-by-list"},e.map((e,t)=>{const a=e.user?e.user.fullname:"User unknown";return c.a.createElement(St.a.Item,{key:t},jt(e),c.a.createElement(St.a.Content,null,c.a.createElement(St.a.Description,null,c.a.createElement("strong",null,_t()(e.addedAt,"dd mmm yyyy @ h:MM tt"))," - ",a)))})),jt=e=>e&&e.user&&e.user.picture?c.a.createElement(Nt.a,{avatar:!0,className:"added_by_avatar_image",src:e.user.picture}):c.a.createElement(ut.a,{name:"user"});var Rt=({users:e=[]})=>{const t=jt(e[0]);return e.length?c.a.createElement(Dt.a,{wide:!0,content:Pt(e),trigger:t}):t};a(638);const wt=e=>Math.round(e/10-5),It=e=>c.a.createElement(St.a,null,e.votes.map((e,t)=>{const a=e.user?e.user.fullname:"User unknown",n=c.a.createElement(Tt.a,{circular:!0,size:"mini"},wt(e.vote));return c.a.createElement(St.a.Item,{key:t},xt(e),c.a.createElement(St.a.Content,null,c.a.createElement(St.a.Description,null,c.a.createElement("strong",null,_t()(e.at,"dd mmm yyyy @ h:MM tt"))," - ",a," ",n)))})),xt=e=>e&&e.user&&e.user.picture?c.a.createElement(Nt.a,{avatar:!0,className:"voted_by_avatar_image",src:e.user.picture}):null,Ut=e=>{let t=!0,a="grey",n="thumbs up";const r=wt(e.total);return r<0&&(n="thumbs down"),r>4&&(a="green",t=!1),r<-4&&(a="red",t=!1),c.a.createElement(Tt.a,{className:"track-label vote-track-label",size:e.size||"tiny",color:a,basic:t,icon:n,content:r,ribbon:e.ribbon?"right":null})};var Lt=e=>{const t=e.votes?e.votes.length:0;return e.show?t<1?Ut(e):c.a.createElement(Dt.a,{wide:"very",content:It(e),trigger:Ut(e)}):null},Mt=a(375);var Vt=()=>{const e=Object(o.c)(e=>e.timer),t=Object(o.c)(e=>e.track),a=(e=>{if(0===e.duration)return 0;const t=Pe(e.position),a=Pe(e.duration),n=Math.round(t/a*100);return isNaN(n)?0:n})(e);return c.a.createElement("div",{className:"progress-container"},c.a.createElement("span",{className:"remaining-text"},_e(e.remaining)),c.a.createElement("span",{className:"track-length"},_e(t.length)),c.a.createElement(Mt.a,{percent:a}))},Kt=a(115),Bt=a.n(Kt),zt=a(226);a(639),a(640);const Yt={0:{style:{color:"red"},label:c.a.createElement(ut.a,{name:"thumbs down",color:"red"})},50:c.a.createElement(ut.a,{name:"handshake"}),100:{style:{color:"green"},label:c.a.createElement(ut.a,{name:"thumbs up",color:"green"})}},qt=e=>{const t=e.split(":").pop();return"https://open.spotify.com/track/".concat(t)},Gt=e=>{const t=" (".concat(e.album.year,")");return c.a.createElement(Ot.a.Description,null,e.album.name,t)},Ft=e=>{const t=e.map(e=>e.vote);return t.length<1?0:Object(zt.mean)(Object(zt.flatten)(t))},Ht=e=>e>50?"#21ba45":e<50?"red":"gray",Jt=e=>e.metrics?c.a.createElement(Lt,{total:e.metrics.votesAverage,show:e.metrics.votes>0,ribbon:!0}):null,Wt=e=>c.a.createElement(Tt.a,{size:"mini"},"Added",c.a.createElement(Tt.a.Detail,null,e.count)),Qt=e=>e.metrics?c.a.createElement(Tt.a,{size:"mini"},"Played",c.a.createElement(Tt.a.Detail,null,e.metrics.plays)):null,Xt=e=>e.metrics?c.a.createElement(Tt.a,{size:"mini"},"Activity",c.a.createElement(Tt.a.Detail,null,e.metrics.votes)):null;var Zt=e=>{const t=e.track,a=e.onVote,n=e.userID;if(!t)return c.a.createElement(Ot.a,null,c.a.createElement(Nt.a,{src:Bt.a}),c.a.createElement(Ot.a.Content,null,c.a.createElement(Ot.a.Header,null,"Nothing playing"),c.a.createElement(Ot.a.Description,null,"Drag some music here or press play.")));const r=t.addedBy,l=void 0===r?[]:r,s=l[0]&&l[0].votes||[],o=s.find(e=>e.user._id===n),i=o?o.vote:null;return c.a.createElement(Ot.a,null,c.a.createElement(Nt.a,{src:t.image||Bt.a,label:c.a.createElement(Jt,{metrics:t.metrics})}),c.a.createElement(Ot.a.Content,null,c.a.createElement(Vt,null),c.a.createElement(Ot.a.Header,null,t.name),c.a.createElement(Ot.a.Meta,null,t.artist.name),c.a.createElement(Gt,{album:t.album})),c.a.createElement(Ot.a.Content,{extra:!0},c.a.createElement("div",{className:"track-rating-container"},c.a.createElement(ft.a,{disabled:!n,dots:!0,value:i,included:!1,marks:Yt,step:10,onChange:(u=t.uri,e=>a(u,e/10)),handleStyle:{borderColor:Ht(i),backgroundColor:Ht(i)}}))),c.a.createElement(Ot.a.Content,{extra:!0},c.a.createElement(Wt,{count:l.length}),c.a.createElement(Qt,{metrics:t.metrics}),c.a.createElement(Xt,{metrics:t.metrics}),c.a.createElement(Lt,{size:"mini",show:s.length>0,total:Ft(s),votes:s})),c.a.createElement(Ot.a.Content,{extra:!0},c.a.createElement(Rt,{users:t.addedBy}),c.a.createElement("a",{className:"track-uri",href:qt(t.uri),target:"_blank",rel:"noopener noreferrer"},t.uri)));var u};var $t=()=>{const e=Object(r.useContext)(b).googleUser,t=Object(o.c)(e=>e.track),a=Object(o.b)();return c.a.createElement(Zt,{userID:e&&e.googleId,track:t,onVote:(e,t)=>a(((e,t)=>({type:ge,key:ye,params:{uri:e,vote:t}}))(e,t))})};a(641);var ea=()=>{const e=Object(r.useContext)(b),t=e.googleUser,a=e.signIn,n=e.signOut;let l=c.a.createElement(it.a,{icon:"power off",floated:"right",onClick:()=>a(),className:"jb-settings-toggle",title:"Login using Google"});return t&&t.profileObj&&(l=c.a.createElement(Nt.a,{rounded:!0,size:"mini",floated:"right",title:t.profileObj.name,src:t.profileObj.imageUrl,onClick:()=>n()})),c.a.createElement(c.a.Fragment,null,l)},ta=a(4),aa=a.n(ta),na=a(731),ra=a(733),ca=a(163),la=a(729);var sa=e=>{const t=c.a.useState(!1),a=Object(ca.a)(t,2),n=a[0],r=a[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(na.a.Action,{className:"remove-track",onClick:()=>r(!0)},"Remove"),c.a.createElement(la.a,{content:"Are you sure you want to remove: ".concat(e.name),cancelButton:"No thanks",confirmButton:"Do it!",open:n,onCancel:()=>r(!1),onConfirm:t=>{e.onClick(t),r(!1)}}))};a(688);const oa=e=>c.a.createElement(na.a.Avatar,{className:e.isCurrent?"current-image":null,src:e.src}),ia=e=>{const t=e.image?e.image:Bt.a;return c.a.createElement(oa,{src:t,isCurrent:e.isCurrent})},ua=e=>c.a.createElement(na.a.Author,null,e.name),ma=e=>c.a.createElement(na.a.Text,null,c.a.createElement(ra.a,{as:"a",className:"track-search-link",onClick:e.onClick},e.artistName)," ",c.a.createElement("small",null,"(",_e(e.trackLength),")")),da=e=>{if(!e.metrics)return null;const t=e.metrics.votes>0;return t?c.a.createElement(na.a.Action,{as:"span"},c.a.createElement(Lt,{total:e.metrics.votesAverage,show:t})):null},Ea=e=>{if(e.isCurrent||e.disabled)return null;return c.a.createElement(sa,{uri:e.uri,name:e.name,onClick:(t=e.uri,a=e.onClick,()=>a(t))});var t,a},pa=e=>{let t=!0,a="grey";return e.metrics?(e.metrics.plays>0&&(t=!1,a=null),c.a.createElement(na.a.Action,{as:"span"},c.a.createElement(Tt.a,{className:"track-label",size:"tiny",color:a,basic:t},"Played ",c.a.createElement(Tt.a.Detail,null,e.metrics.plays)))):null},ka=e=>{let t=!1;return e.tracks.map((a,n)=>{const r=a.addedBy,l=(s=e.current,o=a.uri,s&&s.uri===o);var s,o;return l&&(t=t||!0),c.a.createElement(na.a,{className:aa()({"current-track":l}),key:"".concat(n).concat(a.uri)},c.a.createElement(ia,{image:a.image,isCurrent:l}),c.a.createElement(na.a.Content,{className:aa()({"track-info":!t})},c.a.createElement(ua,{name:a.name}),c.a.createElement(ma,{artistName:a.artist.name,trackLength:a.length,onClick:e.onArtistSearch(a.artist.name)}),c.a.createElement(na.a.Actions,null,c.a.createElement(da,{metrics:a.metrics}),c.a.createElement(pa,{metrics:a.metrics}),c.a.createElement(na.a.Action,null,c.a.createElement(Rt,{users:r})),c.a.createElement(Ea,{uri:a.uri,name:a.name,disabled:e.disabled,isCurrent:l,onClick:e.onRemove}))))})};var ba=e=>e.tracks?c.a.createElement(na.a.Group,{size:"small"},c.a.createElement(ka,{disabled:e.disabled,tracks:e.tracks,current:e.currentTrack,onRemove:e.onRemoveTrack,onArtistSearch:e.onArtistSearch})):null;var Ca=({onClick:e,disabled:t})=>c.a.createElement(it.a,{animated:"vertical",floated:"right",onClick:e,disabled:t},c.a.createElement(it.a.Content,{hidden:!0},"Search"),c.a.createElement(it.a.Content,{visible:!0},c.a.createElement(ut.a,{name:"search"})));const ga=(e,t)=>{if((e+=5)<=100)return()=>{t(e)}},ya=(e,t)=>{if((e-=5)>=0)return()=>{t(e)}},va=e=>c.a.createElement(it.a,{className:"jb-volume-down",onClick:ya(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(ut.a,{name:"volume down"})),ha=e=>c.a.createElement(it.a,{className:"jb-volume-up",onClick:ga(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(ut.a,{name:"volume up"}));var Oa=({disabled:e,onVolumeChange:t})=>{const a=Object(o.c)(e=>e.jukebox);return c.a.createElement(it.a.Group,{floated:"right"},c.a.createElement(va,{volume:a.volume,onChange:t,disabled:e}),c.a.createElement(it.a.Or,{text:a.volume}),c.a.createElement(ha,{volume:a.volume,onChange:t,disabled:e}))};var Na=e=>{const t=c.a.useState(!1),a=Object(ca.a)(t,2),n=a[0],r=a[1];if(e.disabled)return null;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Tt.a,{horizontal:!0,size:"mini",as:"a",color:"red",onClick:()=>r(!0),className:"jb-clear-button"},"CLEAR"),c.a.createElement(la.a,{content:"Are you sure you want to nuke the playlist?",cancelButton:"No thanks",confirmButton:"Do it!",open:n,onCancel:()=>r(!1),onConfirm:t=>{e.onClear(t),r(!1)}}))},Ta=a(740),fa=a(728),Sa=a(736);a(689);const Da=e=>e.metrics?c.a.createElement(Lt,{size:"mini",total:e.metrics.votesAverage,show:e.metrics.votes>0}):null,Aa=e=>c.a.createElement("div",{className:aa()("search-list-item",{disabled:e.track.explicit}),onClick:e.track.explicit?void 0:e.onClick},c.a.createElement(Nt.a,{floated:"left",src:e.track.image,size:"tiny",title:"Click to add - ".concat(e.track.name," - ").concat(e.track.artist.name),className:"search-list-item__image",disabled:e.track.explicit}),c.a.createElement(St.a.Content,null,c.a.createElement("div",{className:"search-list-item__header"},e.track.name," - ",e.track.artist.name),c.a.createElement("div",{className:"search-list-item__content"},e.track.album.name),c.a.createElement(Da,{metrics:e.track.metrics}))),_a=e=>e.tracks.map(t=>c.a.createElement(Aa,{key:t.track.uri,track:t.track,onClick:()=>e.onAddTrack(t.track.uri)}));var Pa=e=>{const t=e.visible,a=e.onClose,n=e.results,l=e.onSubmit,s=e.query,o=e.onQueryChange,i=e.onAddTrack,u=e.totalPages,m=e.onPageChange,d=Object(r.useRef)(null);return c.a.createElement(Ta.a.Pushable,null,c.a.createElement(Ta.a,{animation:"overlay",icon:"labeled",inverted:"true",vertical:"true",visible:t,width:"very wide",direction:"right",className:"sidebar-search",onShow:()=>d.current.focus()},c.a.createElement(fa.a,{inverted:!0,onSubmit:l},c.a.createElement(fa.a.Field,null,c.a.createElement("label",{required:!0},"SEARCH"),c.a.createElement("input",{ref:d,placeholder:"track, artist or album",onChange:o,value:s})),c.a.createElement(it.a,{type:"submit",fluid:!0},"Submit")),c.a.createElement(lt.a,{horizontal:!0},c.a.createElement(ot.a,{as:"h4",inverted:!0},"Results")),u>0&&c.a.createElement(Sa.a,{className:"search-list-pagination",defaultActivePage:1,firstItem:null,lastItem:null,pointing:!0,secondary:!0,totalPages:u,onPageChange:m}),c.a.createElement(St.a,{divided:!0,relaxed:!0,inverted:!0,size:"tiny"},c.a.createElement(_a,{tracks:n,onAddTrack:i}))),c.a.createElement(Ta.a.Pusher,{dimmed:t,onClick:t?a:null},e.children))};var ja=e=>{const t=Object(o.c)(e=>e.search),a=Object(o.b)(),n=e=>{a((e=>({type:Se,uri:e}))(e)),a(G(e))},r=e=>{const n={offset:(e.activePage-1)*t.limit,limit:t.limit};a(we(t.query,n))};return c.a.createElement(Pa,{visible:t.searchSideBarOpen,onClose:()=>a(je(!1)),onSubmit:()=>r({activePage:1}),onAddTrack:e=>n(e),onQueryChange:e=>a(Re(e.target.value)),onPageChange:(e,t)=>r(t),results:t.results,totalPages:Math.round(t.total/t.limit),query:t.query},e.children)};a(710);var Ra=e=>{const t=e.online,a=e.disabled,n=e.onPlay,r=e.onStop,l=e.onPause,s=e.onNext,o=e.onPrevious,i=e.onVolumeChange,u=e.onDrop,m=e.onTracklistClear,d=e.onSearchClick,E=e.tracklist,p=e.currentTrack,k=e.onRemoveTrack,b=e.onArtistSearch;return c.a.createElement(ct.a.Dimmable,{blurring:!0,dimmed:!t},c.a.createElement(ht,{disabled:a,onDrop:u},c.a.createElement(ja,null,c.a.createElement($e.a,{className:"header-wrapper",fluid:!0},c.a.createElement(ea,null),c.a.createElement(Oa,{disabled:a,onVolumeChange:i}),c.a.createElement(Ca,{onClick:d,disabled:a}),c.a.createElement(Ct,{disabled:a,onPlay:n,onStop:r,onPause:l,onNext:s,onPrevious:o})),c.a.createElement(lt.a,null),c.a.createElement($e.a,{className:"body-wrapper",fluid:!0},c.a.createElement(st.a,{stackable:!0,columns:2,className:"dashboard-grid"},c.a.createElement(st.a.Column,{width:4},c.a.createElement(ot.a,{size:"small"},"Current Track"),c.a.createElement($t,null)),c.a.createElement(st.a.Column,{width:8},c.a.createElement(ot.a,{size:"small"},"Playlist ",c.a.createElement(Na,{disabled:a,onClear:m})),c.a.createElement(ba,{disabled:a,tracks:E,currentTrack:p,onRemoveTrack:k,onArtistSearch:b})))))))};var wa=Object(et.DragDropContext)(at.a)(()=>{const e=Object(o.c)(e=>e.jukebox),t=Object(o.c)(e=>e.tracklist),a=Object(o.c)(e=>e.track),n=Object(o.b)(),l=Object(r.useContext)(b),s=l.isSignedIn,i=l.googleUser,u=!(s&&e.mopidyOnline),m=Object(r.useRef)(),d=Object(r.useRef)();Object(r.useEffect)(()=>(n(X()),()=>{n(ee())}),[n]),s&&i.tokenId!==m.current&&(m.current=i.tokenId,d.current=rt.refresh(i,e=>{n(Y(e))}),n(Y(m.current))),s||(m.current=void 0,rt.clear(d.current),n(q()));const E=Object(r.useCallback)(()=>n(ie()),[n]),p=Object(r.useCallback)(()=>n(ue()),[n]),k=Object(r.useCallback)(()=>n(me()),[n]),C=Object(r.useCallback)(()=>n(de()),[n]),g=Object(r.useCallback)(()=>n(Ee()),[n]),y=Object(r.useCallback)(e=>n(Ce(e)),[n]),v=Object(r.useCallback)((e,t)=>{t&&n(G(t.getItem().urls[0]))},[n]),h=Object(r.useCallback)(()=>n(oe()),[n]),O=Object(r.useCallback)(()=>n(je(!0)),[n]),N=Object(r.useCallback)(e=>n(W(e)),[n]),T=Object(r.useCallback)(e=>t=>{const a={offset:0};n(we(e,a)),n(Re(e)),n(je(!0))},[n]);return c.a.createElement(Ra,{online:e.online,disabled:u,onPlay:E,onStop:p,onPause:k,onNext:C,onPrevious:g,onVolumeChange:y,onDrop:v,onTracklistClear:h,onSearchClick:O,tracklist:t,currentTrack:a,onRemoveTrack:N,onArtistSearch:T})});a(711);const Ia=Object(i.createStore)(Ze,Object(u.composeWithDevTools)(Object(i.applyMiddleware)(Ke)));var xa=()=>{const e=Object(E.useGoogleLogin)({clientId:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",hostedDomain:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",REACT_APP_WS_URL:"jukebox-api-prod.local",REACT_APP_WS_PORT:"8080"}).GOOGLE_AUTH_DOMAIN});return c.a.createElement(o.a,{store:Ia},c.a.createElement(d.a,null),c.a.createElement($e.a,{fluid:!0},c.a.createElement(b.Provider,{value:e},c.a.createElement(k,null,c.a.createElement(wa,null)))))};a(712);s.a.render(c.a.createElement(xa,null),document.getElementById("root"))}},[[385,1,2]]]);
//# sourceMappingURL=main.f7b26401.chunk.js.map
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{117:function(e,t,a){e.exports=a.p+"static/media/default-artwork.6bba9800.png"},223:function(e,t){e.exports={transformUrl:e=>{const t=e.replace(/^.*\/track\//,"spotify:track:");return t.match(/spotify:track/g)?t:null}}},383:function(e,t,a){e.exports=a(711)},421:function(e,t){},561:function(e,t,a){},620:function(e,t,a){},636:function(e,t,a){},638:function(e,t,a){},639:function(e,t,a){},686:function(e,t,a){},687:function(e,t,a){},708:function(e,t,a){},710:function(e,t,a){},711:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"updateToken",(function(){return K})),a.d(n,"clearToken",(function(){return Y})),a.d(n,"addNewTrack",(function(){return H})),a.d(n,"addNewTracks",(function(){return q})),a.d(n,"addCurrentTrack",(function(){return G})),a.d(n,"syncSocialData",(function(){return J})),a.d(n,"addTrackList",(function(){return W})),a.d(n,"removeFromTracklist",(function(){return Q})),a.d(n,"updateProgressTimer",(function(){return X})),a.d(n,"wsConnect",(function(){return Z})),a.d(n,"wsConnecting",(function(){return $})),a.d(n,"wsConnected",(function(){return ee})),a.d(n,"wsDisconnect",(function(){return te})),a.d(n,"wsDisconnected",(function(){return ae})),a.d(n,"mopidyConnected",(function(){return ne})),a.d(n,"mopidyDisconnected",(function(){return re})),a.d(n,"getCurrentTrack",(function(){return ce})),a.d(n,"getTimePosition",(function(){return se})),a.d(n,"getState",(function(){return le})),a.d(n,"getTrackList",(function(){return oe})),a.d(n,"clearTrackList",(function(){return ie})),a.d(n,"startPlaying",(function(){return me})),a.d(n,"stopPlaying",(function(){return ue})),a.d(n,"pausePlaying",(function(){return de})),a.d(n,"nextPlaying",(function(){return Ee})),a.d(n,"previousPlaying",(function(){return pe})),a.d(n,"getVolume",(function(){return ke})),a.d(n,"updateVolume",(function(){return be})),a.d(n,"updatePlaybackState",(function(){return ge})),a.d(n,"setVolume",(function(){return Ce}));var r=a(0),c=a.n(r),s=a(23),l=a.n(s),o=a(22),i=a(50),m=a(341),u=a(99),d=a.n(u),E=a(342);class p extends c.a.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){this.setState({hasError:!0})}render(){return this.state.hasError?c.a.createElement("h1",null,"Ouch! I broke a bit."):this.props.children}}var k=p;var b=c.a.createContext(),g=a(343),C=a.n(g),v="playback.getCurrentTrack",y="event:trackPlaybackStarted",h="event:playbackStateChanged",T="event:trackPlaybackResumed",f="tracklist.getTracks",O="tracklist.add",N="tracklist.remove",S="tracklist.clear",D="playback.getTimePosition",A="playback.getState",_="playback.play",j="playback.stop",P="playback.pause",R="playback.next",w="playback.previous",x="playing",I="paused",L="stopped",M="mixer.setVolume",U="mixer.getVolume",V="event:volumeChanged",z="validationError",B={ADD_CURRENT_TRACK:"actionAddCurrentTrack",ADD_TRACKS:"actionAddTracks",CONNECT:"actionConnect",CONNECTING:"actionConnecting",CONNECTED:"actionConnected",DISCONNECT:"actionDisconnect",DISCONNECTED:"actionDisconnected",DROP_TYPES:["__NATIVE_URL__"],SEND:"actionSend",STORE_TOKEN:"actionStoreToken",CLEAR_STORE_TOKEN:"actionClearStoreToken",UPDATE_VOLUME:"actionUpdateVolume",UPDATE_PLAYBACK_STATE:"actionPlaybackState",UPDATE_PROGRESS_TIMER:"actionUpdateProgressTimer",MOPIDY_CONNECTED:"actionMopidyConnected",MOPIDY_DISCONNECTED:"actionMopidyDisconnected",SYNC_SOCIAL_DATA:"syncSocialData"},F=a(223);const K=(e,t)=>({type:B.STORE_TOKEN,tokenExpires:t,token:e}),Y=()=>({type:B.CLEAR_STORE_TOKEN}),H=e=>{let t=Object(F.transformUrl)(e);return{type:B.SEND,key:O,params:{uris:[t]}}},q=e=>({type:B.SEND,key:O,params:{uris:e.map(e=>Object(F.transformUrl)(e))}}),G=e=>({type:B.ADD_CURRENT_TRACK,track:e}),J=e=>({type:B.SYNC_SOCIAL_DATA,track:e}),W=e=>({type:B.ADD_TRACKS,tracks:e}),Q=e=>({type:B.SEND,key:N,params:{criteria:{uri:[e]}}}),X=(e,t)=>(t===1/0&&(t=0),{type:B.UPDATE_PROGRESS_TIMER,position:e,duration:t}),Z=()=>({type:B.CONNECT}),$=()=>({type:B.CONNECTING}),ee=()=>({type:B.CONNECTED}),te=()=>({type:B.DISCONNECT}),ae=()=>({type:B.DISCONNECTED}),ne=()=>({type:B.MOPIDY_CONNECTED}),re=()=>({type:B.MOPIDY_DISCONNECTED}),ce=()=>({type:B.SEND,key:v}),se=()=>({type:B.SEND,key:D}),le=()=>({type:B.SEND,key:A}),oe=()=>({type:B.SEND,key:f}),ie=()=>({type:B.SEND,key:S}),me=()=>({type:B.SEND,key:_}),ue=()=>({type:B.SEND,key:j}),de=()=>({type:B.SEND,key:P}),Ee=()=>({type:B.SEND,key:R}),pe=()=>({type:B.SEND,key:w}),ke=()=>({type:B.SEND,key:U}),be=e=>({type:B.UPDATE_VOLUME,volume:e}),ge=e=>({type:B.UPDATE_PLAYBACK_STATE,state:e}),Ce=e=>({type:B.SEND,key:M,params:[Number(e)]});var ve="actionVote",ye="castVote",he="voteCasted",Te="actionTrackSearch",fe="searchGetTracks",Oe="actionStoreSearchResults",Ne="actionStoreSearchQuery",Se="actionToggleSearchSidebar",De="actionRemoveFromSearchResults",Ae="curateAddTrackToMix",_e="curateRemoveTracksFromMix",je="searchSwapTracks",Pe="searchClearMix",Re=a(344),we=a.n(Re);const xe=e=>{let t=Math.floor(e/6e4),a=(e%6e4/1e3).toFixed(0);return t+":"+(a<10?"0":"")+a},Ie=e=>.001*e,Le=e=>({type:Se,open:e}),Me=e=>({type:Ne,query:e}),Ue=(e,t)=>({type:Te,key:fe,params:{query:e,options:t}}),Ve=e=>({type:De,uris:e});var ze="authenticationTokenInvalid";var Be={decode:e=>JSON.parse(e),encodeToJson:({jwt:e,key:t,data:a})=>JSON.stringify({jwt:e,key:t,data:a})};var Fe={info:({id:e,title:t,message:a})=>u.store.addNotification({id:e,title:t,message:a,type:"info",insert:"top",container:"bottom-left",dismiss:{duration:3e3}}),success:({id:e,title:t,message:a})=>u.store.addNotification({id:e,title:t,message:a,type:"success",insert:"top",container:"bottom-left",dismiss:{duration:3e3}}),warning:({id:e,title:t,message:a})=>u.store.addNotification({id:e,title:t,message:a,type:"warning",insert:"top",container:"bottom-left",dismiss:{duration:5e3}})};const Ke=(e,t)=>{e.dispatch(ge(t))};var Ye=(e,t,a)=>{const n=Be.decode(t),r=n.key,c=n.data,s=n.user;switch(r){case ze:console.error("AUTHENTICATION_TOKEN_INVALID: ".concat(c.error)),e.dispatch(Y());break;case v:case y:c&&((e,t,a)=>{t.dispatch(G(e)),t.dispatch(J(e));const n=a.set(0,e.length);t.getState().jukebox.playbackState===x&&n.start()})(c,e,a);break;case h:case A:((e,t,a)=>{switch(t){case I:case L:Ke(e,t),a.stop();break;case x:Ke(e,t),a.start()}})(e,c,a);break;case f:((e,t)=>{t.dispatch(W(e))})(c,e);break;case R:case w:e.dispatch(ce());break;case M:Fe.info({title:"Volume Updated",message:"".concat(s.fullname," changed it to ").concat(c.volume)});break;case N:Fe.warning({title:"Track Removed",message:"".concat(s.fullname," removed: ").concat(c.message)});break;case O:Fe.success({title:"New Track",message:"".concat(s.fullname," added: ").concat(c.message)});break;case U:case V:e.dispatch(be(c.volume));break;case D:a.set(c);break;case fe:e.dispatch({type:Oe,results:c});break;case he:c&&e.dispatch(J(c));break;case T:a.set(c);break;case z:Fe.warning({title:"Oops",message:c.message})}};var He={loadInitial:e=>{["getCurrentTrack","getState","getTrackList","getVolume","getTimePosition"].forEach(t=>{e.dispatch(n[t]())})}};var qe=(()=>{const e="http://".concat("jukebox-api-prod.local",":").concat("8080");let t,a=null;return r=>c=>s=>{const l=()=>Be.encodeToJson({jwt:r.getState().settings.token,key:s.key,data:s.params}),o=e=>{if(JSON.parse(e).online)return r.dispatch(ne()),He.loadInitial(r);r.dispatch(re())},i=()=>{a=((e,t)=>we()({callback:(a,n)=>{e.dispatch(t.updateProgressTimer(a,n))},fallbackTargetFrameRate:1,disableRequestAnimationFrame:!0}))(r,n),r.dispatch(ee())},m=()=>r.dispatch(te()),u=e=>Ye(r,e,a),d=e=>Ye(r,e,a),E=e=>Ye(r,e,a);switch(s.type){case B.CONNECT:return null!=t&&t.close(),t=C()(e,{transports:["websocket"]}),t.on("vote",E),t.on("search",d),t.on("mopidy",o),t.on("message",u),t.on("connect",i),t.on("disconnect",m),void r.dispatch($());case B.DISCONNECT:return a&&a.reset(),void r.dispatch(ae());case B.SEND:return t&&t.emit("message",l());case Te:return t&&t.emit("search",l());case ve:return t&&t.emit("vote",l());default:return c(s)}}})();var Ge=(e=null,t)=>{switch(t.type){case B.ADD_CURRENT_TRACK:return t.track;case B.SYNC_SOCIAL_DATA:return Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics});default:return e}};var Je=(e=[],t)=>{switch(t.type){case B.ADD_TRACKS:return t.tracks;case B.SYNC_SOCIAL_DATA:return e.map(e=>e.uri===t.track.uri?Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics}):e);default:return e}};const We={position:0,duration:0,remaining:0};var Qe=(e=We,t)=>{switch(t.type){case B.UPDATE_PROGRESS_TIMER:return{position:t.position,duration:t.duration,remaining:t.duration-t.position};default:return e}};const Xe={online:!1,mopidyOnline:!1,volume:0,playbackState:L};var Ze=(e=Xe,t)=>{switch(t.type){case B.CONNECTED:return Object.assign({},e,{online:!0});case B.DISCONNECTED:return Object.assign({},e,{online:!1});case B.MOPIDY_CONNECTED:return Object.assign({},e,{mopidyOnline:!0});case B.MOPIDY_DISCONNECTED:return Object.assign({},e,{mopidyOnline:!1});case B.UPDATE_VOLUME:return Object.assign({},e,{volume:t.volume});case B.UPDATE_PLAYBACK_STATE:return Object.assign({},e,{playbackState:t.state});default:return e}};const $e={tokenExpires:0,token:null};var et=(e=$e,t)=>{switch(t.type){case B.STORE_TOKEN:return t.token===e.token?e:Object.assign({},e,{token:t.token,tokenExpires:t.tokenExpires});case B.CLEAR_STORE_TOKEN:return $e;default:return e}},tt=a(47);const at={searchSideBarOpen:!1,query:"",limit:20,offset:0,total:0,results:[]};var nt=(e=at,t)=>{switch(t.type){case De:return Object(tt.a)(Object(tt.a)({},e),{},{results:e.results.filter(e=>!t.uris.includes(e.uri))});case Se:return Object.assign({},e,{searchSideBarOpen:t.open});case Ne:return Object.assign({},e,{query:t.query});case Oe:return Object.assign({},e,{limit:t.results.limit,offset:t.results.offset,total:t.results.total>1e4?1e4:t.results.total,results:t.results.tracks});default:return e}};const rt={tracks:[]};var ct=(e=rt,t)=>{switch(t.type){case Ae:return e.tracks.find(e=>e.uri===t.track.uri)||e.tracks.push(t.track),e;case _e:return Object(tt.a)(Object(tt.a)({},e),{},{tracks:e.tracks.filter(e=>e.uri!==t.uri)});case je:{const a=e.tracks;return a[t.a]=a.splice(t.b,1,a[t.a])[0],Object(tt.a)(Object(tt.a)({},e),{},{tracks:a})}case Pe:return Object(tt.a)(Object(tt.a)({},e),{},{tracks:[]});default:return e}};var st=Object(i.combineReducers)({track:Ge,tracklist:Je,timer:Qe,jukebox:Ze,settings:et,search:nt,curatedList:ct}),lt=a(725),ot=a(98);const it=()=>!document["undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":"hidden"];function mt(){const e=c.a.useState(it()),t=Object(ot.a)(e,2),a=t[0],n=t[1],r=()=>n(it());return c.a.useEffect(()=>{const e="undefined"!==typeof document.msHidden?"msvisibilitychange":"undefined"!==typeof document.webkitHidden?"webkitvisibilitychange":"visibilitychange";return document.addEventListener(e,r,!1),()=>{document.removeEventListener(e,r)}}),a}var ut=a(92),dt=a(157),Et=a.n(dt),pt=a(737),kt=a(724),bt=a(740),gt=a(738),Ct=a(736),vt=a(63);const yt=e=>c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",className:"jb-previous-button",disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Prev"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"step backward"}))),ht=e=>c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",className:"jb-next-button",disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Next"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"step forward"})));var Tt=({disabled:e,onPrevious:t,onNext:a})=>c.a.createElement(c.a.Fragment,null,c.a.createElement(yt,{onClick:t,disabled:e}),c.a.createElement(ht,{onClick:a,disabled:e}));const ft=e=>c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===x||e.disabled,active:e.state===x,className:"jb-play-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Play"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"play"}))),Ot=e=>c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===I||e.state===L||e.disabled,active:e.state===I,className:"jb-pause-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Pause"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"pause"}))),Nt=e=>c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===L||e.disabled,active:e.state===L,className:"jb-stop-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Stop"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"stop"})));var St=e=>{const t=Object(o.c)(e=>e.jukebox),a=e.disabled,n=e.onPlay,r=e.onPause,s=e.onStop,l=e.onPrevious,i=e.onNext;return c.a.createElement("span",null,c.a.createElement(Tt,{disabled:a,onPrevious:l,onNext:i}),c.a.createElement(ft,{onClick:n,state:t.playbackState,disabled:a}),c.a.createElement(Ot,{onClick:r,state:t.playbackState,disabled:a}),c.a.createElement(Nt,{onClick:s,state:t.playbackState,disabled:a}))};a(561);const Dt={drop(e,t){e.onDrop&&e.onDrop(e,t)}};class At extends r.Component{render(){const e=this.props,t=e.connectDropTarget,a=e.isOver;return t(c.a.createElement("div",null,a?c.a.createElement("div",{className:"drag-is-over"},c.a.createElement("p",null,"Drop da track")):null,this.props.children))}}var _t=Object(ut.DropTarget)(e=>e.accepts,Dt,(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver()}))(At);var jt=({disabled:e,onDrop:t,children:a})=>e?a:c.a.createElement(ut.DragDropContextProvider,{backend:Et.a},c.a.createElement(_t,{accepts:B.DROP_TYPES,onDrop:t},a));var Pt=a(733),Rt=a(374),wt=a(164),xt=a(372),It=a(732),Lt=a(730),Mt=a(161),Ut=a.n(Mt);a(620);const Vt=e=>c.a.createElement(It.a,{className:"added-by-list"},e.map((e,t)=>{const a=e.user?e.user.fullname:"User unknown";return c.a.createElement(It.a.Item,{key:t},zt(e),c.a.createElement(It.a.Content,null,c.a.createElement(It.a.Description,null,c.a.createElement("strong",null,Ut()(e.addedAt,"dd mmm yyyy @ h:MM tt"))," - ",a)))})),zt=e=>e&&e.user&&e.user.picture?c.a.createElement(Rt.a,{avatar:!0,className:"added_by_avatar_image",src:e.user.picture}):c.a.createElement(vt.a,{name:"user"});var Bt=({users:e=[]})=>{const t=zt(e[0]);return e.length?c.a.createElement(Lt.a,{wide:!0,content:Vt(e),trigger:t}):t};a(636);const Ft=e=>Math.round(e/10-5),Kt=e=>c.a.createElement(It.a,null,e.votes.map((e,t)=>{const a=e.user?e.user.fullname:"User unknown",n=c.a.createElement(wt.a,{circular:!0,size:"mini"},Ft(e.vote));return c.a.createElement(It.a.Item,{key:t},Yt(e),c.a.createElement(It.a.Content,null,c.a.createElement(It.a.Description,null,c.a.createElement("strong",null,Ut()(e.at,"dd mmm yyyy @ h:MM tt"))," - ",a," ",n)))})),Yt=e=>e&&e.user&&e.user.picture?c.a.createElement(Rt.a,{avatar:!0,className:"voted_by_avatar_image",src:e.user.picture}):null,Ht=e=>{let t=!0,a="grey",n="thumbs up";const r=Ft(e.total);return r<0&&(n="thumbs down"),r>4&&(a="green",t=!1),r<-4&&(a="red",t=!1),c.a.createElement(wt.a,{className:"track-label vote-track-label",size:e.size||"tiny",color:a,basic:t,icon:n,content:r,ribbon:e.ribbon?"right":null})};var qt=e=>{const t=e.votes?e.votes.length:0;return e.show?t<1?Ht(e):c.a.createElement(Lt.a,{wide:"very",content:Kt(e),trigger:Ht(e)}):null},Gt=a(373);var Jt=()=>{const e=Object(o.c)(e=>e.timer),t=Object(o.c)(e=>e.track),a=(e=>{if(0===e.duration)return 0;const t=Ie(e.position),a=Ie(e.duration),n=Math.round(t/a*100);return isNaN(n)?0:n})(e);return c.a.createElement("div",{className:"progress-container"},c.a.createElement("span",{className:"remaining-text"},xe(e.remaining)),c.a.createElement("span",{className:"track-length"},xe(t.length)),c.a.createElement(Gt.a,{percent:a}))},Wt=a(117),Qt=a.n(Wt),Xt=a(227);a(637),a(638);const Zt={0:{style:{color:"red"},label:c.a.createElement(vt.a,{name:"thumbs down",color:"red"})},50:c.a.createElement(vt.a,{name:"handshake"}),100:{style:{color:"green"},label:c.a.createElement(vt.a,{name:"thumbs up",color:"green"})}},$t=e=>{const t=e.split(":").pop();return"https://open.spotify.com/track/".concat(t)},ea=e=>{const t=" (".concat(e.album.year,")");return c.a.createElement(Pt.a.Description,null,e.album.name,t)},ta=e=>{const t=e.map(e=>e.vote);return t.length<1?0:Object(Xt.mean)(Object(Xt.flatten)(t))},aa=e=>e>50?"#21ba45":e<50?"red":"gray",na=e=>e.metrics?c.a.createElement(qt,{total:e.metrics.votesAverage,show:e.metrics.votes>0,ribbon:!0}):null,ra=e=>c.a.createElement(wt.a,{size:"mini"},"Added",c.a.createElement(wt.a.Detail,null,e.count)),ca=e=>e.metrics?c.a.createElement(wt.a,{size:"mini"},"Played",c.a.createElement(wt.a.Detail,null,e.metrics.plays)):null,sa=e=>e.metrics?c.a.createElement(wt.a,{size:"mini"},"Activity",c.a.createElement(wt.a.Detail,null,e.metrics.votes)):null;var la=e=>{const t=e.track,a=e.onVote,n=e.userID;if(!t)return c.a.createElement(Pt.a,null,c.a.createElement(Rt.a,{src:Qt.a}),c.a.createElement(Pt.a.Content,null,c.a.createElement(Pt.a.Header,null,"Nothing playing"),c.a.createElement(Pt.a.Description,null,"Drag some music here or press play.")));const r=t.addedBy,s=void 0===r?[]:r,l=s[0]&&s[0].votes||[],o=l.find(e=>e.user._id===n),i=o?o.vote:null;return c.a.createElement(Pt.a,null,c.a.createElement(Rt.a,{src:t.image||Qt.a,label:c.a.createElement(na,{metrics:t.metrics})}),c.a.createElement(Pt.a.Content,null,c.a.createElement(Jt,null),c.a.createElement(Pt.a.Header,null,t.name),c.a.createElement(Pt.a.Meta,null,t.artist.name),c.a.createElement(ea,{album:t.album})),c.a.createElement(Pt.a.Content,{extra:!0},c.a.createElement("div",{className:"track-rating-container"},c.a.createElement(xt.a,{disabled:!n,dots:!0,value:i,included:!1,marks:Zt,step:10,onChange:(m=t.uri,e=>a(m,e/10)),handleStyle:{borderColor:aa(i),backgroundColor:aa(i)}}))),c.a.createElement(Pt.a.Content,{extra:!0},c.a.createElement(ra,{count:s.length}),c.a.createElement(ca,{metrics:t.metrics}),c.a.createElement(sa,{metrics:t.metrics}),c.a.createElement(qt,{size:"mini",show:l.length>0,total:ta(l),votes:l})),c.a.createElement(Pt.a.Content,{extra:!0},c.a.createElement(Bt,{users:t.addedBy}),c.a.createElement("a",{className:"track-uri",href:$t(t.uri),target:"_blank",rel:"noopener noreferrer"},t.uri)));var m};var oa=()=>{const e=Object(r.useContext)(b).googleUser,t=Object(o.c)(e=>e.track),a=Object(o.b)();return c.a.createElement(la,{userID:e&&e.googleId,track:t,onVote:(e,t)=>a(((e,t)=>({type:ve,key:ye,params:{uri:e,vote:t}}))(e,t))})};a(639);var ia=()=>{const e=Object(r.useContext)(b),t=e.googleUser,a=e.grantOfflineAccess,n=e.signOut;let s=c.a.createElement(Ct.a,{icon:"power off",floated:"right",onClick:()=>a(),className:"jb-settings-toggle",title:"Login using Google"});return t&&t.profileObj&&(s=c.a.createElement(Rt.a,{rounded:!0,size:"mini",floated:"right",title:t.profileObj.name,src:t.profileObj.imageUrl,onClick:()=>n()})),c.a.createElement(c.a.Fragment,null,s)},ma=a(4),ua=a.n(ma),da=a(729),Ea=a(731),pa=a(727);var ka=e=>{const t=c.a.useState(!1),a=Object(ot.a)(t,2),n=a[0],r=a[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(da.a.Action,{className:"remove-track",onClick:()=>r(!0)},"Remove"),c.a.createElement(pa.a,{content:"Are you sure you want to remove: ".concat(e.name),cancelButton:"No thanks",confirmButton:"Do it!",open:n,onCancel:()=>r(!1),onConfirm:t=>{e.onClick(t),r(!1)}}))};a(686);const ba=e=>c.a.createElement(da.a.Avatar,{className:e.isCurrent?"current-image":null,src:e.src}),ga=e=>{const t=e.image?e.image:Qt.a;return c.a.createElement(ba,{src:t,isCurrent:e.isCurrent})},Ca=e=>c.a.createElement(da.a.Author,null,e.name),va=e=>c.a.createElement(da.a.Text,null,c.a.createElement(Ea.a,{as:"a",className:"track-search-link",onClick:e.onClick},e.artistName)," ",c.a.createElement("small",null,"(",xe(e.trackLength),")")),ya=e=>{if(!e.metrics)return null;const t=e.metrics.votes>0;return t?c.a.createElement(da.a.Action,{as:"span"},c.a.createElement(qt,{total:e.metrics.votesAverage,show:t})):null},ha=e=>{if(e.isCurrent||e.disabled)return null;return c.a.createElement(ka,{uri:e.uri,name:e.name,onClick:(t=e.uri,a=e.onClick,()=>a(t))});var t,a},Ta=e=>{let t=!0,a="grey";return e.metrics?(e.metrics.plays>0&&(t=!1,a=null),c.a.createElement(da.a.Action,{as:"span"},c.a.createElement(wt.a,{className:"track-label",size:"tiny",color:a,basic:t},"Played ",c.a.createElement(wt.a.Detail,null,e.metrics.plays)))):null},fa=e=>{let t=!1;return e.tracks.map((a,n)=>{const r=a.addedBy,s=(l=e.current,o=a.uri,l&&l.uri===o);var l,o;return s&&(t=t||!0),c.a.createElement(da.a,{className:ua()({"current-track":s}),key:"".concat(n).concat(a.uri)},c.a.createElement(ga,{image:a.image,isCurrent:s}),c.a.createElement(da.a.Content,{className:ua()({"track-info":!t})},c.a.createElement(Ca,{name:a.name}),c.a.createElement(va,{artistName:a.artist.name,trackLength:a.length,onClick:e.onArtistSearch(a.artist.name)}),c.a.createElement(da.a.Actions,null,c.a.createElement(ya,{metrics:a.metrics}),c.a.createElement(Ta,{metrics:a.metrics}),c.a.createElement(da.a.Action,null,c.a.createElement(Bt,{users:r})),c.a.createElement(ha,{uri:a.uri,name:a.name,disabled:e.disabled,isCurrent:s,onClick:e.onRemove}))))})};var Oa=e=>e.tracks?c.a.createElement(da.a.Group,{size:"small"},c.a.createElement(fa,{disabled:e.disabled,tracks:e.tracks,current:e.currentTrack,onRemove:e.onRemoveTrack,onArtistSearch:e.onArtistSearch})):null;var Na=e=>c.a.createElement(Ct.a,{animated:"vertical",floated:"right",onClick:e.onClick,disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Search"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(vt.a,{name:"search"})));const Sa=(e,t)=>{if((e+=5)<=100)return()=>{t(e)}},Da=(e,t)=>{if((e-=5)>=0)return()=>{t(e)}},Aa=e=>c.a.createElement(Ct.a,{className:"jb-volume-down",onClick:Da(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(vt.a,{name:"volume down"})),_a=e=>c.a.createElement(Ct.a,{className:"jb-volume-up",onClick:Sa(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(vt.a,{name:"volume up"}));var ja=({disabled:e,onVolumeChange:t})=>{const a=Object(o.c)(e=>e.jukebox);return c.a.createElement(Ct.a.Group,{floated:"right"},c.a.createElement(Aa,{volume:a.volume,onChange:t,disabled:e}),c.a.createElement(Ct.a.Or,{text:a.volume}),c.a.createElement(_a,{volume:a.volume,onChange:t,disabled:e}))};var Pa=e=>{const t=c.a.useState(!1),a=Object(ot.a)(t,2),n=a[0],r=a[1];if(e.disabled)return null;return c.a.createElement(c.a.Fragment,null,c.a.createElement(wt.a,{horizontal:!0,size:"mini",as:"a",color:"red",onClick:()=>r(!0),className:"jb-clear-button"},"CLEAR"),c.a.createElement(pa.a,{content:"Are you sure you want to nuke the playlist?",cancelButton:"No thanks",confirmButton:"Do it!",open:n,onCancel:()=>r(!1),onConfirm:t=>{e.onClear(t),r(!1)}}))},Ra=a(739),wa=a(726),xa=a(734);const Ia=e=>e.metrics?c.a.createElement(qt,{size:"mini",total:e.metrics.votesAverage,show:e.metrics.votes>0}):null;var La=e=>c.a.createElement("div",{className:ua()(e.className,"search-list-item",{disabled:e.track.explicit})},c.a.createElement(Rt.a,{alt:e.track.name,floated:"left",src:e.track.image,size:"tiny",title:"Click to add - ".concat(e.track.name," - ").concat(e.track.artist.name),className:"search-list-item__image",disabled:e.track.explicit,onClick:e.track.explicit?void 0:e.onClick}),c.a.createElement(It.a.Content,null,c.a.createElement("div",{className:"search-list-item__header"},e.track.name," - ",e.track.artist.name),c.a.createElement("div",{className:"search-list-item__content"},e.track.album.name),c.a.createElement(Ia,{metrics:e.track.metrics}),e.onAdd?c.a.createElement("span",{onClick:e.onAdd,className:"search-list-item__add"},"Add to mix"):null));var Ma=e=>{const t=e.i;return c.a.createElement("div",{draggable:!0,className:ua()("draggable","search-list-item-draggable"),onDragStart:e=>((e,t)=>{e.dataTransfer&&e.dataTransfer.setData("text/plain",t)})(e,String(t)),onDrop:a=>((t,a)=>{const n=t.dataTransfer&&t.dataTransfer.getData("text/plain");n&&e.action(parseInt(a,10),parseInt(n,10))})(a,String(t)),title:"You can drag this to sort."},c.a.createElement(La,{key:e.track.uri,track:e.track}),c.a.createElement("span",{onClick:e.onRemove,className:"search-list-item__remove"},"Remove"))};a(687);const Ua=e=>c.a.createElement(c.a.Fragment,null,e.tracks.map(t=>c.a.createElement(La,{key:t.uri,track:t,onClick:()=>e.onClick(t.uri),onAdd:()=>e.onAdd(t)}))),Va=e=>c.a.createElement(c.a.Fragment,null,e.tracks.map((t,a)=>c.a.createElement(Ma,{i:a,key:a,track:t,onRemove:()=>e.onRemove(t.uri),action:e.onSwap}))),za=e=>{if(0===e.tracks.length)return null;const t=e.tracks.map(e=>e.uri);return c.a.createElement(c.a.Fragment,null,c.a.createElement(kt.a,{horizontal:!0},c.a.createElement(gt.a,{as:"h4",inverted:!0},"Your Mix")),c.a.createElement(It.a,{divided:!0,inverted:!0,size:"tiny"},c.a.createElement(Va,{tracks:e.tracks,onRemove:e.onRemoveFromMix,onSwap:e.onSwapTracks})),c.a.createElement(Ct.a,{fluid:!0,onClick:()=>e.onAddTracks(t),className:"search-list-item__add_to_mix"},"Add mix to playlist"),c.a.createElement(kt.a,{horizontal:!0}))};var Ba=e=>{const t=e.visible,a=e.onClose,n=e.results,r=e.curatedList,s=e.onSubmit,l=e.query,o=e.onSwapTracks,i=e.onRemoveFromMix,m=e.onQueryChange,u=e.onAddTrack,d=e.onAddTracks,E=e.onAddTrackToMix,p=e.totalPages,k=e.onPageChange,b=c.a.useRef(null);return c.a.createElement(Ra.a.Pushable,null,c.a.createElement(Ra.a,{animation:"overlay",icon:"labeled",inverted:"true",vertical:"true",visible:t,width:"very wide",direction:"right",className:"sidebar-search",onShow:()=>b.current&&b.current.focus()},c.a.createElement(za,{tracks:r,onSwapTracks:o,onAddTracks:d,onRemoveFromMix:i}),c.a.createElement(wa.a,{inverted:!0,onSubmit:s},c.a.createElement(wa.a.Field,null,c.a.createElement("label",null,"SEARCH"),c.a.createElement("input",{ref:b,"aria-label":"search-input",placeholder:"track, artist or album",onChange:m,value:l})),c.a.createElement(Ct.a,{type:"submit",fluid:!0},"Find")),c.a.createElement(kt.a,{horizontal:!0},c.a.createElement(gt.a,{as:"h4",inverted:!0},"Results")),p>0&&c.a.createElement(xa.a,{className:"search-list-pagination",defaultActivePage:1,firstItem:null,lastItem:null,pointing:!0,secondary:!0,totalPages:p,onPageChange:k}),c.a.createElement(It.a,{divided:!0,relaxed:!0,inverted:!0,size:"tiny"},c.a.createElement(Ua,{tracks:n,onClick:u,onAdd:E}))),c.a.createElement(Ra.a.Pusher,{dimmed:t,onClick:t?a:null},e.children))};const Fa=e=>e.search,Ka=e=>e.curatedList;var Ya=e=>{const t=Object(o.c)(Fa),a=Object(o.c)(Ka),n=Object(o.b)(),r=(e={activePage:1})=>{const a={offset:(e.activePage-1)*t.limit,limit:t.limit};n(Ue(t.query,a))};return c.a.createElement(Ba,{visible:t.searchSideBarOpen,onClose:()=>n(Le(!1)),onSubmit:()=>r(),onSwapTracks:(e,t)=>{n(((e,t)=>({type:je,a:e,b:t}))(e,t))},onAddTrack:e=>{n(Ve([e])),n(H(e))},onAddTracks:e=>{n(q(e)),n({type:Pe})},onAddTrackToMix:e=>{a.tracks.length<5&&(n(Ve([e.uri])),n((e=>({type:Ae,track:e}))(e)))},onRemoveFromMix:e=>{n((e=>({type:_e,uri:e}))(e)),r()},onQueryChange:e=>n(Me(e.target.value)),onPageChange:(e,t)=>r(t),results:t.results,curatedList:a.tracks,totalPages:Math.round(t.total/t.limit),query:t.query},e.children)};a(708);var Ha=e=>{const t=e.online,a=e.disabled,n=e.onPlay,r=e.onStop,s=e.onPause,l=e.onNext,o=e.onPrevious,i=e.onVolumeChange,m=e.onDrop,u=e.onTracklistClear,d=e.onSearchClick,E=e.tracklist,p=e.currentTrack,k=e.onRemoveTrack,b=e.onArtistSearch;return c.a.createElement(pt.a.Dimmable,{blurring:!0,dimmed:!t},c.a.createElement(jt,{disabled:a,onDrop:m},c.a.createElement(Ya,null,c.a.createElement(lt.a,{className:"header-wrapper",fluid:!0},c.a.createElement(ia,null),c.a.createElement(ja,{disabled:a,onVolumeChange:i}),c.a.createElement(Na,{onClick:d,disabled:a}),c.a.createElement(St,{disabled:a,onPlay:n,onStop:r,onPause:s,onNext:l,onPrevious:o})),c.a.createElement(kt.a,null),c.a.createElement(lt.a,{className:"body-wrapper",fluid:!0},c.a.createElement(bt.a,{stackable:!0,columns:2,className:"dashboard-grid"},c.a.createElement(bt.a.Column,{width:4},c.a.createElement(gt.a,{size:"small"},"Current Track"),c.a.createElement(oa,null)),c.a.createElement(bt.a.Column,{width:8},c.a.createElement(gt.a,{size:"small"},"Playlist ",c.a.createElement(Pa,{disabled:a,onClear:u})),c.a.createElement(Oa,{disabled:a,tracks:E,currentTrack:p,onRemoveTrack:k,onArtistSearch:b})))))))};var qa=Object(ut.DragDropContext)(Et.a)(()=>{const e=mt(),t=Object(o.c)(e=>e.settings),a=Object(o.c)(e=>e.jukebox),n=Object(o.c)(e=>e.tracklist),s=Object(o.c)(e=>e.track),l=Object(o.b)(),i=Object(r.useContext)(b),m=i.isSignedIn,u=i.googleUser,d=i.auth2,E=!(m&&a.mopidyOnline);if(Object(r.useEffect)(()=>(l(Z()),()=>l(te())),[l]),m&&e){const e=()=>t.tokenExpires>0&&t.tokenExpires-3e5-Date.now()<=0;u.expiresAt>t.tokenExpires&&l(K(u.tokenId,u.expiresAt)),e()&&d.currentUser.get().reloadAuthResponse().then(e=>{console.info("Token Refreshed (expires): ",e.expires_at),l(K(e.id_token,e.expires_at))},e=>console.warn("Token un-refreshable: ",e.message))}m||l(Y());const p=Object(r.useCallback)(()=>l(me()),[l]),k=Object(r.useCallback)(()=>l(ue()),[l]),g=Object(r.useCallback)(()=>l(de()),[l]),C=Object(r.useCallback)(()=>l(Ee()),[l]),v=Object(r.useCallback)(()=>l(pe()),[l]),y=Object(r.useCallback)(e=>l(Ce(e)),[l]),h=Object(r.useCallback)((e,t)=>{t&&l(H(t.getItem().urls[0]))},[l]),T=Object(r.useCallback)(()=>l(ie()),[l]),f=Object(r.useCallback)(()=>l(Le(!0)),[l]),O=Object(r.useCallback)(e=>l(Q(e)),[l]),N=Object(r.useCallback)(e=>t=>{const a={offset:0};l(Ue(e,a)),l(Me(e)),l(Le(!0))},[l]);return c.a.createElement(Ha,{online:a.online,disabled:E,onPlay:p,onStop:k,onPause:g,onNext:C,onPrevious:v,onVolumeChange:y,onDrop:h,onTracklistClear:T,onSearchClick:f,tracklist:n,currentTrack:s,onRemoveTrack:O,onArtistSearch:N})});a(709);const Ga=Object(i.createStore)(st,Object(m.composeWithDevTools)(Object(i.applyMiddleware)(qe)));var Ja=()=>{const e=Object(E.useGoogleLogin)({clientId:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",hostedDomain:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",REACT_APP_WS_URL:"jukebox-api-prod.local",REACT_APP_WS_PORT:"8080"}).GOOGLE_AUTH_DOMAIN});return c.a.createElement(o.a,{store:Ga},c.a.createElement(d.a,null),c.a.createElement(lt.a,{fluid:!0},c.a.createElement(b.Provider,{value:e},c.a.createElement(k,null,c.a.createElement(qa,null)))))};a(710);l.a.render(c.a.createElement(Ja,null),document.getElementById("root"))}},[[383,1,2]]]);
//# sourceMappingURL=main.0bcc16ac.chunk.js.map